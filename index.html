<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>深圳速度：三十年人口剧变 (1985-2020)</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700&family=Noto+Serif+SC:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-paper: #F9F7F2;
            --color-primary: #E67F65;
            --color-secondary: #5E9EA8;
            --color-text: #2D3436;
            --color-text-light: #636e72;
            --grid-line: #E5E0D8;
            --font-en: 'Montserrat', sans-serif;
            --font-cn: 'Noto Serif SC', serif;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-paper);
            height: 100vh;
            width: 100vw;
            overflow: hidden; /* 默认隐藏滚动条，内容溢出由子容器处理 */
            font-family: var(--font-en);
        }

        /* 核心容器：使用 CSS Grid 
           默认（桌面）布局：左边图表(70%)，右边信息(30%)
           高度撑满 100vh
        */
        .poster-container {
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: 70% 30%; /* 左右分割 */
            background-color: var(--bg-paper);
            position: relative;
            /* 背景纹理 */
            background-image: 
                linear-gradient(var(--grid-line) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* 装饰图案：调整定位方式，使其在任何屏幕都不突兀 */
        .deco-circle {
            position: absolute;
            top: -10vmin;
            right: -10vmin;
            width: 40vmin;
            height: 40vmin;
            border: 2px solid var(--color-secondary);
            border-radius: 50%;
            opacity: 0.1;
            z-index: 0;
            pointer-events: none; /* 防止遮挡点击 */
        }
        
        .deco-circle::before {
            content: '';
            position: absolute;
            top: 20%;
            left: 20%;
            width: 60%;
            height: 60%;
            border: 1px dashed var(--color-primary);
            border-radius: 50%;
        }

        /* 左侧主图表区 */
        .chart-area {
            position: relative;
            padding: 3vmin;
            display: flex;
            flex-direction: column;
            z-index: 1;
            height: 100%; /* 撑满高度 */
            overflow: hidden;
        }

        .main-title {
            font-family: var(--font-cn);
            color: var(--color-text);
            margin-bottom: 10px;
            flex-shrink: 0; /* 防止标题被压缩 */
        }

        .main-title h1 {
            font-size: 5vmin; /* 使用 vmin 适配横竖屏 */
            margin: 0;
            line-height: 1;
            letter-spacing: -1px;
        }
        
        .main-title h1 span {
            color: var(--color-primary);
            font-style: italic;
        }

        .main-title p {
            font-family: var(--font-en);
            font-size: 1.5vmin;
            color: var(--color-text-light);
            margin: 1vmin 0 0 5px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        /* 图表容器：
           关键点：使用 flex: 1 让它自动占据剩余的所有高度 
        */
        #timelineChart {
            flex: 1; 
            width: 100%;
            min-height: 0; /* 关键：防止 flex 子项溢出 */
            margin-top: 20px;
        }

        /* 右侧信息栏 */
        .info-sidebar {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(8px);
            border-left: 1px solid var(--grid-line);
            padding: 3vmin;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            z-index: 2;
            height: 100%;
            overflow-y: auto; /* 如果屏幕太矮，允许侧边栏滚动 */
        }

        .story-block {
            margin-bottom: 3vh;
        }

        .story-title {
            font-family: var(--font-cn);
            font-size: 2.2vmin;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 1.5vh;
            display: flex;
            align-items: center;
        }

        .story-title::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 2.5vmin;
            background: var(--color-primary);
            margin-right: 10px;
            border-radius: 2px;
        }

        .story-text {
            font-family: var(--font-cn);
            font-size: 1.6vmin; /* 稍微调大一点，保证可读性 */
            color: var(--color-text-light);
            line-height: 1.6;
            text-align: justify;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        .stat-item {
            background: #fff;
            padding: 1.5vmin;
            border: 1px solid #eee;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.02);
        }

        .stat-num {
            font-family: var(--font-en);
            font-size: 3.5vmin;
            font-weight: 700;
            color: var(--color-primary);
        }

        .stat-label {
            font-size: 1.2vmin;
            color: var(--color-text-light);
            text-transform: uppercase;
        }

        /* 迷你图表容器 */
        .mini-chart-container {
            height: 20vh;
            width: 100%;
            min-height: 150px; /* 保证最小高度 */
        }

        .quote-box {
            margin-top: auto;
            border-top: 1px solid var(--color-text-light);
            padding-top: 2vmin;
        }

        .quote {
            font-family: var(--font-cn);
            font-size: 2vmin;
            font-style: italic;
            color: var(--color-text);
            line-height: 1.4;
        }

        .caption {
            font-size: 1vmin;
            color: var(--color-text-light);
            margin-top: 5px;
            display: block;
            text-align: right;
        }

        /* === 响应式适配 === 
           当屏幕宽度小于 768px (手机/竖屏平板) 时切换布局
        */
        @media (max-width: 768px) {
            .poster-container {
                grid-template-columns: 1fr; /* 单列 */
                grid-template-rows: 55% 45%; /* 上下分割：图表55%，文字45% */
            }

            .info-sidebar {
                border-left: none;
                border-top: 1px solid var(--grid-line);
                padding: 20px;
                /* 手机上允许内容多时滚动 */
                overflow-y: auto; 
            }

            /* 调整手机上的字体大小，因为 vmin 在竖屏时基于宽度，可能太小 */
            .main-title h1 { font-size: 28px; }
            .main-title p { font-size: 10px; }
            .story-title { font-size: 16px; }
            .story-title::before { height: 16px; }
            .story-text { font-size: 13px; }
            .stat-num { font-size: 24px; }
            .stat-label { font-size: 10px; }
            .quote { font-size: 14px; }
            
            /* 手机上隐藏装饰圆环，避免干扰 */
            .deco-circle { opacity: 0.05; width: 60vw; height: 60vw; }
        }
    </style>
</head>
<body>

    <div class="poster-container">
        <!-- 装饰背景 -->
        <div class="deco-circle"></div>

        <!-- 左侧/上方：主要视觉区 -->
        <div class="chart-area">
            <div class="main-title">
                <h1>SHENZHEN <span>VELOCITY</span></h1>
                <h1>城市生长的力量</h1>
                <p>Population Explosion & Urban Evolution 1985-2020</p>
            </div>
            
            <!-- 主图表挂载点 -->
            <div id="timelineChart"></div>
        </div>

        <!-- 右侧/下方：叙事与数据区 -->
        <div class="info-sidebar">
            
            <div class="story-block">
                <div class="story-title">剧变的三十五年</div>
                <div class="story-text">
                    从1985年的 <strong style="color:var(--color-primary)">88万</strong> 到2020年的 <strong style="color:var(--color-primary)">1763万</strong>，深圳的人口增长曲线不仅是数字的累积，更是中国改革开放最直观的注脚。这不仅是人口的迁徙，更是一座现代化大都市平地而起的奇迹。
                </div>
            </div>

            <div class="story-block">
                <div class="stat-grid">
                    <div class="stat-item">
                        <div class="stat-num">20x</div>
                        <div class="stat-label">Total Growth<br>总增长倍数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-num">70%</div>
                        <div class="stat-label">Migrant Pop.<br>非户籍占比</div>
                    </div>
                </div>
            </div>

            <div class="story-block">
                <div class="story-title">倒挂的结构</div>
                <div class="story-text">
                    独特的“倒挂”现象：非户籍人口长期占据主导地位，展现了这座城市极强的包容性与流动性。
                </div>
                <!-- 迷你饼图 -->
                <div id="pieChart" class="mini-chart-container"></div>
            </div>

            <div class="quote-box">
                <div class="quote">
                    “来了就是深圳人”
                </div>
                <span class="caption">数据来源：深圳市统计年鉴</span>
            </div>
        </div>
    </div>

<script>
    // --- 数据 ---
    const data = {
        years: [
            "1985", "1986", "1987", "1988", "1989", 
            "1990", "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", 
            "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", 
            "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"
        ],
        total: [
            88.15, 93.56, 105.44, 120.14, 141.60,
            167.78, 226.76, 268.02, 335.97, 412.71, 449.15, 482.89, 527.75, 580.33, 632.56,
            701.24, 724.57, 746.62, 778.27, 800.80, 827.75, 871.10, 912.37, 954.28, 995.01,
            1037.20, 1122.94, 1195.85, 1257.17, 1317.86, 1408.05, 1495.35, 1587.31, 1666.12, 1710.40, 1763.38
        ]
    };

    // --- 主图表 (Timeline) ---
    const chartDom = document.getElementById('timelineChart');
    const myChart = echarts.init(chartDom);

    const option = {
        grid: {
            top: '15%',
            left: '2%',
            right: '4%',
            bottom: '8%', // 稍微增加底部，防止 label 被切
            containLabel: true // 关键：自动计算边距，适应全屏缩放
        },
        tooltip: {
            trigger: 'axis',
            backgroundColor: 'rgba(255,255,255,0.9)',
            textStyle: { fontFamily: 'Noto Serif SC' }
        },
        xAxis: {
            type: 'category',
            boundaryGap: false,
            data: data.years,
            axisLine: { lineStyle: { color: '#888' } },
            axisLabel: { 
                interval: 'auto', // 自动间隔，适应不同宽度
                fontFamily: 'Montserrat',
                color: '#636e72',
                fontSize: 12
            },
            axisTick: { show: false }
        },
        yAxis: {
            type: 'value',
            position: 'right', 
            splitLine: { 
                show: true, 
                lineStyle: { type: 'dashed', color: '#E5E0D8' } 
            },
            axisLine: { show: false },
            axisLabel: { 
                formatter: '{value} 万',
                color: '#636e72',
                fontFamily: 'Noto Serif SC'
            }
        },
        series: [
            {
                name: '常住人口',
                type: 'line',
                smooth: true,
                symbol: 'none',
                data: data.total,
                lineStyle: {
                    width: 4,
                    color: '#E67F65',
                    shadowColor: 'rgba(230, 127, 101, 0.4)',
                    shadowBlur: 10,
                    shadowOffsetY: 5
                },
                areaStyle: {
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: 'rgba(230, 127, 101, 0.4)' },
                        { offset: 1, color: 'rgba(230, 127, 101, 0.01)' }
                    ])
                },
                markPoint: {
                    symbol: 'circle',
                    symbolSize: 10,
                    itemStyle: { color: '#2D3436' },
                    label: {
                        show: true,
                        position: 'top',
                        formatter: '{b}\n{c}万',
                        fontFamily: 'Noto Serif SC',
                        backgroundColor: '#fff',
                        padding: [4, 8],
                        borderRadius: 4,
                        borderColor: '#E67F65',
                        borderWidth: 1,
                        color: '#2D3436'
                    },
                    data: [
                        { coord: ['1985', 88.15], value: 88.15, name: '起点' },
                        { coord: ['2000', 701.24], value: 701.24, name: '千禧年' },
                        { coord: ['2020', 1763.38], value: 1763.38, name: '2020' }
                    ]
                },
                markLine: {
                    symbol: ['none', 'none'],
                    label: { show: true, position: 'insideEndTop', formatter: '{b}' },
                    lineStyle: { color: '#5E9EA8', type: 'dashed', width: 1 },
                    data: [
                        { xAxis: '1992', label: { formatter: '1992 南方谈话', padding:[0,0,5,-10], color:'#5E9EA8' } },
                        { xAxis: '2010', label: { formatter: '2010 特区扩容', padding:[0,0,5,-10], color:'#5E9EA8' } }
                    ]
                }
            }
        ]
    };
    myChart.setOption(option);

    // --- 迷你饼图 (Pie) ---
    const pieDom = document.getElementById('pieChart');
    const pieChart = echarts.init(pieDom);
    
    // 2020 数据
    const pieOption = {
        color: ['#E67F65', '#5E9EA8'],
        tooltip: { trigger: 'item' },
        // 调整图例位置以适应可能的窄屏
        legend: { top: '5%', right: '0%', orient: 'vertical', icon: 'circle' },
        series: [
            {
                name: '2020人口结构',
                type: 'pie',
                radius: ['50%', '80%'],
                center: ['35%', '50%'], // 稍微左移，留位置给 Legend
                avoidLabelOverlap: false,
                itemStyle: {
                    borderRadius: 5,
                    borderColor: '#fff',
                    borderWidth: 2
                },
                label: { show: false },
                data: [
                    { value: 1249.28, name: '非户籍' },
                    { value: 514.10, name: '户籍' }
                ]
            }
        ]
    };
    pieChart.setOption(pieOption);

    // 响应式：监听 resize 并强制重绘图表
    window.addEventListener('resize', () => {
        myChart.resize();
        pieChart.resize();
    });

</script>
</body>
</html>
